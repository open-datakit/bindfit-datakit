{
  "datapackage": {
    "title": "Bindfit",
    "description": "Binding constant fitter",
    "algorithms": [
      {
        "name": "bindfit",
        "title": "Bindfit",
        "code": "ZGVmIG1haW4oCiAgICBkYXRhLAogICAgcGFyYW1zLAogICAgb3B0aW9ucywKICAgIG91dHB1dHMsCiAgICAqKmt3YXJncywKKToKICAgIGltcG9ydCBudW1weSBhcyBucAogICAgaW1wb3J0IHBhbmRhcyBhcyBwZAoKICAgIGltcG9ydCBiaW5kZml0CgoKICAgICMgQ29udmVydCBwYXJhbXMgdG8gQmluZGZpdCBmb3JtYXQKICAgICMgVE9ETzogTW9kaWZ5IGxpYnJhcnkgdG8gYWNjZXB0IEZyaWN0aW9ubGVzcyBwYXJhbXMgZm9ybWF0CiAgICBiaW5kZml0X3BhcmFtcyA9IHt9CgogICAgZm9yIGtleSwgcGFyYW0gaW4gcGFyYW1zWyJkYXRhIl0uaXRlbXMoKToKICAgICAgICBiaW5kZml0X3BhcmFtcy51cGRhdGUoewogICAgICAgICAgICBrZXk6IHsKICAgICAgICAgICAgICAgICJpbml0IjogcGFyYW1bInZhbHVlIl0sCiAgICAgICAgICAgICAgICAiYm91bmRzIjogewogICAgICAgICAgICAgICAgICAgICJtaW4iOiBwYXJhbVsibG93ZXJCb3VuZCJdLAogICAgICAgICAgICAgICAgICAgICJtYXgiOiBwYXJhbVsidXBwZXJCb3VuZCJdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfQogICAgICAgIH0pCgogICAgIyBCaW5kZml0IG9wdGlvbnMKICAgIG1vZGVsID0gb3B0aW9uc1siZGF0YSJdWyJtb2RlbCJdCiAgICBtZXRob2QgPSBvcHRpb25zWyJkYXRhIl1bIm1ldGhvZCJdCiAgICBub3JtYWxpc2UgPSBvcHRpb25zWyJkYXRhIl1bIm5vcm1hbGlzZSJdCiAgICBkaWx1dGUgPSBvcHRpb25zWyJkYXRhIl1bImRpbHV0ZSJdCiAgICBmbGF2b3VyID0gb3B0aW9uc1siZGF0YSJdWyJmbGF2b3VyIl0KCiAgICAjIExvYWQgZGF0YQogICAgIyBUT0RPOiBTcGxpdCB0aGlzIGZ1bmN0aW9uIG91dCBpbnRvIGRhdGFwYWNrYWdlLXV0aWxpdGllcyBsaWJyYXJ5CiAgICBkZWYgZGF0YXBhY2thZ2VfdG9fZGF0YWZyYW1lKGRwKToKICAgICAgICBkZiA9IHBkLkRhdGFGcmFtZS5mcm9tX2RpY3QoZHBbImRhdGEiXSkKICAgICAgICAjIFJlb3JkZXIgY29sdW1ucyBieSBzY2hlbWEgZmllbGQgb3JkZXIKICAgICAgICBjb2xzID0gWyBmaWVsZFsibmFtZSJdIGZvciBmaWVsZCBpbiBkcFsic2NoZW1hIl1bImZpZWxkcyJdIF0KICAgICAgICBkZiA9IGRmW2NvbHNdCiAgICAgICAgcmV0dXJuIGRmCgogICAgZGYgPSBkYXRhcGFja2FnZV90b19kYXRhZnJhbWUoZGF0YSkKCiAgICAjIEJpbmRmaXQgZXhwZWN0cyBlYWNoIHZhcmlhYmxlIGFzIHJvd3MKICAgIGRhdGFfeCA9IG5wLnRyYW5zcG9zZShkZi5pbG9jWzosIDoyXS50b19udW1weSgpKQogICAgZGF0YV95ID0gbnAudHJhbnNwb3NlKGRmLmlsb2NbOiwgMjpdLnRvX251bXB5KCkpCgogICAgIyBBcHBseSBkaWx1dGlvbiBjb3JyZWN0aW9uCiAgICAjIFRPRE86IFRoaW5rIGFib3V0IHdoZXJlIHRoaXMgc2hvdWxkIGdvIC0gZml0dGVyIG9yIGZ1bmN0aW9uPwogICAgIyBPciBqdXN0IGFwcGx5IGl0IGJlZm9yZSB0aGUgZml0PwogICAgaWYgZGlsdXRlOgogICAgICAgIGRhdGFfeSA9IGJpbmRmaXQuaGVscGVycy5kaWx1dGUoZGF0YV94WzBdLCBkYXRhX3kpCgogICAgZnVuY3Rpb24gPSBiaW5kZml0LmZ1bmN0aW9ucy5jb25zdHJ1Y3QoCiAgICAgICAgbW9kZWwsCiAgICAgICAgbm9ybWFsaXNlPW5vcm1hbGlzZSwKICAgICAgICBmbGF2b3VyPWZsYXZvdXIsCiAgICApCgogICAgZml0dGVyID0gYmluZGZpdC5maXR0ZXIuRml0dGVyKAogICAgICAgIGRhdGFfeCwgZGF0YV95LCBmdW5jdGlvbiwgbm9ybWFsaXNlPW5vcm1hbGlzZSwgcGFyYW1zPWJpbmRmaXRfcGFyYW1zCiAgICApCgogICAgZml0dGVyLnJ1bl9zY2lweShiaW5kZml0X3BhcmFtcywgbWV0aG9kPW1ldGhvZCkKCiAgICBzdW1tYXJ5ID0gewogICAgICAgICJmaXR0ZXIiOiBtb2RlbCwKICAgICAgICAiZml0IjogewogICAgICAgICAgICAieSI6IGZpdHRlci5maXQsCiAgICAgICAgICAgICJjb2VmZnNfcmF3IjogZml0dGVyLmNvZWZmc19yYXcsCiAgICAgICAgICAgICJjb2VmZnMiOiBmaXR0ZXIuY29lZmZzLAogICAgICAgICAgICAibW9sZWZyYWNfcmF3IjogZml0dGVyLm1vbGVmcmFjX3JhdywKICAgICAgICAgICAgIm1vbGVmcmFjIjogZml0dGVyLm1vbGVmcmFjLAogICAgICAgICAgICAicGFyYW1zIjogZml0dGVyLnBhcmFtcywKICAgICAgICAgICAgIm5feSI6IG5wLmFycmF5KGZpdHRlci5maXQpLnNpemUsCiAgICAgICAgICAgICJuX3BhcmFtcyI6IGxlbihmaXR0ZXIucGFyYW1zKSArIG5wLmFycmF5KGZpdHRlci5jb2VmZnNfcmF3KS5zaXplLAogICAgICAgIH0sCiAgICAgICAgInFvZiI6IHsKICAgICAgICAgICAgInJlc2lkdWFscyI6IGZpdHRlci5yZXNpZHVhbHMsCiAgICAgICAgICAgICJzc3IiOiBiaW5kZml0LmhlbHBlcnMuc3NyKGZpdHRlci5yZXNpZHVhbHMpLAogICAgICAgICAgICAicm1zIjogYmluZGZpdC5oZWxwZXJzLnJtcyhmaXR0ZXIucmVzaWR1YWxzKSwKICAgICAgICAgICAgImNvdiI6IGJpbmRmaXQuaGVscGVycy5jb3YoZGF0YV95LCBmaXR0ZXIucmVzaWR1YWxzKSwKICAgICAgICAgICAgInJtc190b3RhbCI6IGJpbmRmaXQuaGVscGVycy5ybXMoZml0dGVyLnJlc2lkdWFscywgdG90YWw9VHJ1ZSksCiAgICAgICAgICAgICJjb3ZfdG90YWwiOiBiaW5kZml0LmhlbHBlcnMuY292KGRhdGFfeSwgZml0dGVyLnJlc2lkdWFscywgdG90YWw9VHJ1ZSksCiAgICAgICAgfSwKICAgICAgICAidGltZSI6IGZpdHRlci50aW1lLAogICAgICAgICJvcHRpb25zIjogewogICAgICAgICAgICAiZGlsdXRlIjogZGlsdXRlLAogICAgICAgICAgICAibm9ybWFsaXNlIjogbm9ybWFsaXNlLAogICAgICAgICAgICAibWV0aG9kIjogbWV0aG9kLAogICAgICAgICAgICAiZmxhdm91ciI6IGZsYXZvdXIsCiAgICAgICAgfSwKICAgIH0KCiAgICAjIFRPRE86IFRoaXMgY29udmVyc2lvbiBzaG91bGQgYmUgbW92ZWQgdG8gQmluZGZpdCBsaWJyYXJ5CiAgICBmb3Iga2V5LCBwYXJhbSBpbiBmaXR0ZXIucGFyYW1zLml0ZW1zKCk6CiAgICAgICAgb3V0cHV0c1sicGFyYW1zIl0udXBkYXRlKHsKICAgICAgICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICBrZXk6IHsKICAgICAgICAgICAgICAgICAgICAidmFsdWUiOiBwYXJhbVsidmFsdWUiXSwKICAgICAgICAgICAgICAgICAgICAic3RkZXJyIjogcGFyYW1bInN0ZGVyciJdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICB9KQoKICAgICMgVHJhbnNsYXRlIGZpdHRlci5maXQgaW50byBKU09OIGZvciB0YWJ1bGFyIGRhdGEgc2NoZW1hCiAgICAjIFRPRE86IFRoaXMgc2hvdWxkIGJlIGRvbmUgYnkgdGhlIEJpbmRmaXQgbGlicmFyeQogICAgZGVmIGZpdF90b19qc29uKGRhdGEsIGZpdCk6CiAgICAgICAgeF9maWVsZHMgPSBbIGlbIm5hbWUiXSBmb3IgaSBpbiBkYXRhWyJzY2hlbWEiXVsiZmllbGRzIl1bOjJdIF0KICAgICAgICB5X2ZpZWxkcyA9IFsgaVsibmFtZSJdIGZvciBpIGluIGRhdGFbInNjaGVtYSJdWyJmaWVsZHMiXVsyOl0gXQoKICAgICAgICBmaXRfZGF0YSA9IFtdCgogICAgICAgIGZvciBkYXRhX3JvdywgZml0X3JvdyBpbiB6aXAoZGF0YVsiZGF0YSJdLCBmaXQuVCk6CiAgICAgICAgICAgIHJvdyA9IHt9CgogICAgICAgICAgICBmb3IgZmllbGQgaW4geF9maWVsZHM6CiAgICAgICAgICAgICAgICByb3dbZmllbGRdID0gZGF0YV9yb3dbZmllbGRdCgogICAgICAgICAgICBmb3IgaSwgZmllbGQgaW4gZW51bWVyYXRlKHlfZmllbGRzKToKICAgICAgICAgICAgICAgIHJvd1tmaWVsZF0gPSBmaXRfcm93W2ldCgogICAgICAgICAgICBmaXRfZGF0YS5hcHBlbmQocm93KQoKICAgICAgICByZXR1cm4gZml0X2RhdGEKCiAgICBvdXRwdXRzWyJmaXQiXVsiZGF0YSJdID0gZml0X3RvX2pzb24oZGF0YSwgZml0dGVyLmZpdCkKICAgIG91dHB1dHNbImZpdCJdWyJzY2hlbWEiXSA9IGRhdGFbInNjaGVtYSJdCgogICAgcmV0dXJuIG91dHB1dHMK",
        "inputs": [
          {
            "name": "data",
            "type": "resource",
            "resource": "inputData"
          },
          {
            "name": "params",
            "type": "resource",
            "resource": "inputParams"
          },
          {
            "name": "options",
            "type": "resource",
            "resource": "inputOptions"
          }
        ],
        "outputs": [
          {
            "name": "params",
            "type": "resource",
            "resource": "outputParams"
          },
          {
            "name": "fit",
            "type": "resource",
            "resource": "outputFit"
          }
        ]
      }
    ],
    "resources": [
      {
        "name": "inputData",
        "title": "Input data",
        "description": "Input data",
        "profile": "tabular-data-resource",
        "data": [
          {
            "Host": 0.000776,
            "Guest": 0.0,
            "Proton 1": 0.0,
            "Proton 2": 0.0,
            "Proton 3": 0.0,
            "Proton 4": 0.0
          },
          {
            "Host": 0.000776,
            "Guest": 9.70537e-05,
            "Proton 1": -0.0039,
            "Proton 2": -0.0005,
            "Proton 3": 0.0007,
            "Proton 4": 0.0002
          },
          {
            "Host": 0.000776,
            "Guest": 0.000193437,
            "Proton 1": -0.0074,
            "Proton 2": -0.001,
            "Proton 3": 0.0024,
            "Proton 4": 0.0012
          },
          {
            "Host": 0.000776,
            "Guest": 0.000289157,
            "Proton 1": -0.0113,
            "Proton 2": -0.0015,
            "Proton 3": 0.00365,
            "Proton 4": 0.0017
          },
          {
            "Host": 0.000776,
            "Guest": 0.00038422,
            "Proton 1": -0.0147,
            "Proton 2": -0.002,
            "Proton 3": 0.0044,
            "Proton 4": 0.00195
          },
          {
            "Host": 0.000776,
            "Guest": 0.000478632,
            "Proton 1": -0.0176,
            "Proton 2": -0.0025,
            "Proton 3": 0.00535,
            "Proton 4": 0.0022
          },
          {
            "Host": 0.000776,
            "Guest": 0.000572402,
            "Proton 1": -0.021,
            "Proton 2": -0.0029,
            "Proton 3": 0.00605,
            "Proton 4": 0.0027
          },
          {
            "Host": 0.000776,
            "Guest": 0.000665535,
            "Proton 1": -0.0245,
            "Proton 2": -0.0034,
            "Proton 3": 0.00655,
            "Proton 4": 0.00295
          },
          {
            "Host": 0.000776,
            "Guest": 0.000758037,
            "Proton 1": -0.0274,
            "Proton 2": -0.0039,
            "Proton 3": 0.00755,
            "Proton 4": 0.0032
          },
          {
            "Host": 0.000776,
            "Guest": 0.000849916,
            "Proton 1": -0.0299,
            "Proton 2": -0.0034,
            "Proton 3": 0.00855,
            "Proton 4": 0.0039
          },
          {
            "Host": 0.000776,
            "Guest": 0.000941176,
            "Proton 1": -0.0328,
            "Proton 2": -0.0044,
            "Proton 3": 0.00925,
            "Proton 4": 0.0041
          },
          {
            "Host": 0.000776,
            "Guest": 0.001076923,
            "Proton 1": -0.0362,
            "Proton 2": -0.0049,
            "Proton 3": 0.0102,
            "Proton 4": 0.00435
          },
          {
            "Host": 0.000776,
            "Guest": 0.001255814,
            "Proton 1": -0.0411,
            "Proton 2": -0.0059,
            "Proton 3": 0.0117,
            "Proton 4": 0.00485
          },
          {
            "Host": 0.000776,
            "Guest": 0.001476112,
            "Proton 1": -0.0465,
            "Proton 2": -0.0064,
            "Proton 3": 0.01315,
            "Proton 4": 0.0056
          },
          {
            "Host": 0.000776,
            "Guest": 0.001778502,
            "Proton 1": -0.0528,
            "Proton 2": -0.0074,
            "Proton 3": 0.0151,
            "Proton 4": 0.00635
          },
          {
            "Host": 0.000776,
            "Guest": 0.002198718,
            "Proton 1": -0.0611,
            "Proton 2": -0.0093,
            "Proton 3": 0.0171,
            "Proton 4": 0.00685
          },
          {
            "Host": 0.000776,
            "Guest": 0.002804382,
            "Proton 1": -0.0699,
            "Proton 2": -0.0103,
            "Proton 3": 0.0205,
            "Proton 4": 0.0083
          },
          {
            "Host": 0.000776,
            "Guest": 0.003569044,
            "Proton 1": -0.0797,
            "Proton 2": -0.0118,
            "Proton 3": 0.0234,
            "Proton 4": 0.0095
          },
          {
            "Host": 0.000776,
            "Guest": 0.004632801,
            "Proton 1": -0.09,
            "Proton 2": -0.0132,
            "Proton 3": 0.0273,
            "Proton 4": 0.01125
          },
          {
            "Host": 0.000776,
            "Guest": 0.006213802,
            "Proton 1": -0.1012,
            "Proton 2": -0.0147,
            "Proton 3": 0.0317,
            "Proton 4": 0.01315
          },
          {
            "Host": 0.000776,
            "Guest": 0.008810489,
            "Proton 1": -0.1139,
            "Proton 2": -0.0171,
            "Proton 3": 0.03565,
            "Proton 4": 0.0144
          },
          {
            "Host": 0.000776,
            "Guest": 0.012504331,
            "Proton 1": -0.1237,
            "Proton 2": -0.0181,
            "Proton 3": 0.04055,
            "Proton 4": 0.0169
          }
        ],
        "schema": {
          "primaryKey": "Host",
          "fields": [
            {
              "name": "Host",
              "title": "Host",
              "unit": "",
              "type": "number"
            },
            {
              "name": "Guest",
              "title": "Guest",
              "unit": "",
              "type": "number"
            },
            {
              "name": "Proton 1",
              "title": "Proton 1",
              "unit": "",
              "type": "number"
            },
            {
              "name": "Proton 2",
              "title": "Proton 2",
              "unit": "",
              "type": "number"
            },
            {
              "name": "Proton 3",
              "title": "Proton 3",
              "unit": "",
              "type": "number"
            },
            {
              "name": "Proton 4",
              "title": "Proton 4",
              "unit": "",
              "type": "number"
            }
          ]
        }
      },
      {
        "name": "inputParams",
        "title": "Input parameters",
        "description": "Initial parameter values",
        "profile": "parameter-data-resource",
        "data": {
          "k": {
            "vary": true,
            "value": 100,
            "lowerBound": 0,
            "upperBound": null
          }
        },
        "schema": {
          "keys": [
            {
              "name": "k",
              "unit": "M^{-1}",
              "fields": [
                {
                  "name": "vary",
                  "title": "Vary",
                  "type": "boolean"
                },
                {
                  "name": "value",
                  "title": "Value",
                  "type": "number"
                },
                {
                  "name": "lowerBound",
                  "title": "Lower bound",
                  "type": "number"
                },
                {
                  "name": "upperBound",
                  "title": "Upper bound",
                  "type": "number"
                }
              ]
            }
          ]
        }
      },
      {
        "name": "inputOptions",
        "title": "Fit options",
        "description": "Fit options",
        "profile": "options-data-resource",
        "data": {
          "model": "nmr1to1",
          "method": "Nelder-Mead",
          "normalise": true,
          "dilute": false,
          "flavour": "none"
        },
        "schema": {
          "fields": [
            {
              "name": "model",
              "title": "Fit model",
              "description": "The model to fit to the data",
              "type": "object",
              "objectFields": [
                {
                  "name": "title",
                  "type": "string"
                },
                {
                  "name": "name",
                  "type": "string"
                }
              ],
              "constraints": {
                "enum": [
                  {
                    "title": "NMR 1:1",
                    "name": "nmr1to1"
                  }
                ]
              }
            },
            {
              "name": "method",
              "title": "Fit method",
              "description": "The optimisation method to use for fitting",
              "type": "object",
              "objectFields": [
                {
                  "name": "title",
                  "type": "string"
                },
                {
                  "name": "name",
                  "type": "string"
                }
              ],
              "constraints": {
                "enum": [
                  {
                    "title": "Nelder-Mead",
                    "name": "Nelder-Mead"
                  },
                  {
                    "title": "L-BFGS-B",
                    "name": "L-BFGS-B"
                  }
                ]
              }
            },
            {
              "name": "normalise",
              "title": "Subtract initial values",
              "description": "Subtract initial values from data before fitting",
              "type": "boolean"
            },
            {
              "name": "dilute",
              "title": "Dilution correction",
              "description": "Apply dilution correction to data",
              "type": "boolean"
            },
            {
              "name": "flavour",
              "title": "Flavour",
              "description": "Fitting algorithm flavour",
              "type": "object",
              "objectFields": [
                {
                  "name": "title",
                  "type": "string"
                },
                {
                  "name": "name",
                  "type": "string"
                }
              ],
              "constraints": {
                "enum": [
                  {
                    "title": "None (Full)",
                    "name": "none"
                  },
                  {
                    "title": "Non-cooperative",
                    "name": "noncoop"
                  },
                  {
                    "title": "Additive",
                    "name": "add"
                  },
                  {
                    "title": "Statistical",
                    "name": "stat"
                  }
                ]
              }
            }
          ]
        }
      },
      {
        "name": "outputParams",
        "title": "Optimised parameters",
        "description": "Optimised parameter values",
        "profile": "parameter-data-resource",
        "data": {
          "k": {}
        },
        "schema": {
          "keys": [
            {
              "name": "k",
              "unit": "M^{-1}",
              "fields": [
                {
                  "name": "vary",
                  "title": "Vary",
                  "type": "boolean"
                },
                {
                  "name": "value",
                  "title": "Value",
                  "type": "number"
                },
                {
                  "name": "stderr",
                  "title": "Error",
                  "type": "number"
                },
                {
                  "name": "lowerBound",
                  "title": "Lower bound",
                  "type": "number"
                },
                {
                  "name": "upperBound",
                  "title": "Upper bound",
                  "type": "number"
                }
              ]
            }
          ]
        }
      },
      {
        "name": "outputFit",
        "title": "Fit",
        "description": "Output fit",
        "profile": "tabular-data-resource",
        "data": [],
        "schema": {
          "primaryKey": "",
          "fields": []
        }
      }
    ],
    "views": [
      {
        "name": "upload",
        "specType": "opendatafit-upload",
        "spec": {},
        "resources": [
          "inputData"
        ]
      },
      {
        "name": "params",
        "title": "Parameters",
        "specType": "opendatafit-params",
        "spec": {
          "keys": [
            {
              "name": "k"
            }
          ]
        },
        "resources": [
          "inputParams",
          "outputParams"
        ]
      },
      {
        "name": "dataTable",
        "spec": {},
        "specType": "opendatafit-table",
        "resources": [
          "inputData"
        ]
      },
      {
        "name": "fitTable",
        "spec": {},
        "specType": "opendatafit-table",
        "resources": [
          "outputFit"
        ]
      }
    ],
    "displays": [
      {
        "name": "main",
        "algorithms": [
          "bindfit"
        ],
        "layout": {
          "type": "bindfit",
          "spec": {
            "panes": [
              {
                "name": "control",
                "tabs": [
                  "inputs"
                ]
              },
              {
                "name": "main",
                "tabs": [
                  "outputs"
                ]
              }
            ],
            "tabs": [
              {
                "name": "inputs",
                "title": "Inputs",
                "icon": "",
                "views": [
                  "upload",
                  "params"
                ]
              },
              {
                "name": "outputs",
                "title": "Outputs",
                "icon": "",
                "views": [
                  "dataTable",
                  "fitTable"
                ]
              }
            ]
          }
        }
      }
    ]
  },
  "algorithm": "bindfit"
}